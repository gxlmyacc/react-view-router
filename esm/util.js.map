{"version":3,"sources":["../src/util.ts"],"names":["nextTick","cb","ctx","Promise","resolve","setTimeout","call","innumerable","obj","key","value","options","configurable","Object","defineProperty","normalizePath","path","paths","split","length","splice","i","join","normalizeRoute","route","parent","depth","force","replace","r","subpath","children","isFunction","normalizeRoutes","exact","undefined","Boolean","redirect","index","components","component","default","keys","forEach","comp","RouteLazy","updaters","push","c","__children","meta","props","normalizeProps","paramsProps","queryProps","afterEnterGuards","completeCallbacks","routes","_normalized","map","filter","normalizeRoutePath","append","basename","isAbsoluteUrl","matched","config","test","resloveIndex","find","matchRoutes","to","branch","normalizeLocation","location","prevChildren","some","match","pathname","search","fullPath","query","parseQuery","substr","stringifyQuery","_toString","prototype","toString","isPlainObject","isMatchedRoute","isLocation","v","res","Array","isArray","type","val","once","fn","ret","_once","_fn","args","isAcceptRef","$$typeof","REACT_FORWARD_REF_TYPE","__componentClass","__component","React","Component","componentDidMount","__guards","mergeFns","fns","resolveRedirect","from","assign","isRedirect","warn","console","afterInterceptors","interceptors","interceptor","lazy","renderRoute","isValidElement","configProps","_props","configs","name","prop","createComp","defaultProps","params","ref","enableRef","_pending","completeCallback","refHandler","el","componentClass","_reactInternalFiber","refComp","child","stateNode","createElement","inheritProps","result","container","flatten","array","flattend","flat","camelize","str","_","toUpperCase","charAt","toLowerCase","isPropChanged","prev","next","isRouteChanged","isRoutesChanged","prevs","nexts","changed","getHostRouterView","continueCb","return","memoizedState","_routerView","getParentRoute","view","state","currentRoute"],"mappings":"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","sourcesContent":["import React from 'react';\nimport config from './config';\nimport { RouteLazy } from './route-lazy';\nimport { REACT_FORWARD_REF_TYPE, RouteComponentGuards, getGuardsComponent } from './route-guard';\nimport matchPath, { computeRootMatch } from './match-path';\nimport { ConfigRouteArray, RouteIndexFn, ConfigRoute, MatchedRoute, RouteHistoryLocation } from './types';\nimport { ReactViewContainer } from './router-view';\n\nfunction nextTick(cb: () => void, ctx?: object) {\n  if (!cb) return;\n  return new Promise(function (resolve) {\n    setTimeout(() => resolve(ctx ? cb.call(ctx) : cb()), 0);\n  });\n}\n\nfunction innumerable(\n  obj: object,\n  key: string,\n  value: any,\n  options: PropertyDescriptor = { configurable: true }\n) {\n  Object.defineProperty(obj, key, { value, ...options });\n  return obj;\n}\n\nfunction normalizePath(path: string) {\n  const paths = path.split('/');\n  if (paths.length > 2 && !paths[paths.length - 1]) paths.splice(paths.length - 1, 1);\n  for (let i = paths.length - 1; i > -1; i--) {\n    if (paths[i + 1] === '..') paths.splice(i, 2);\n    else if (paths[i] === '.') paths.splice(i, 1);\n  }\n  return paths.join('/');\n}\n\nfunction normalizeRoute(route: any, parent: any, depth: number = 0, force?: any) {\n  let path = normalizePath(parent ? `${parent.path}/${route.path.replace(/^(\\/)/, '')}` : route.path);\n  let r = { ...route, subpath: route.path, path, depth };\n  if (parent) innumerable(r, 'parent', parent);\n  if (r.children && !isFunction(r.children)) {\n    innumerable(r, 'children', normalizeRoutes(r.children, r, depth + 1, force));\n  }\n  r.depth = depth;\n  r.exact = r.exact !== undefined ? r.exact : Boolean(r.redirect || r.index);\n  if (!r.components) r.components = {};\n  if (r.component) {\n    r.components.default = r.component;\n    delete r.component;\n  }\n  Object.keys(r.components).forEach(key => {\n    let comp = r.components[key];\n    if (comp instanceof RouteLazy) {\n      (comp as RouteLazy).updaters.push(c => {\n        if (c.__children) {\n          let children = c.__children || [];\n          if (isFunction(children)) children = (children as ((r: any) => any[]))(r) || [];\n          innumerable(r, 'children', normalizeRoutes(children as ConfigRouteArray, r, depth + 1));\n          r.exact = !r.children.length;\n        }\n        return r.components[key] = c;\n      });\n    }\n  });\n  if (!r.meta) r.meta = {};\n  if (r.props) innumerable(r, 'props', normalizeProps(r.props));\n  if (r.paramsProps) innumerable(r, 'paramsProps', normalizeProps(r.paramsProps));\n  if (r.queryProps) innumerable(r, 'queryProps', normalizeProps(r.queryProps));\n  innumerable(r, '_pending', { afterEnterGuards: {}, completeCallbacks: {} });\n  return r;\n}\n\n\n\nfunction normalizeRoutes(routes: ConfigRouteArray, parent?: any, depth = 0, force = false) {\n  if (!routes) routes = [] as ConfigRouteArray;\n  if (!force && routes._normalized) return routes;\n  routes = routes.map((route: any) => route && normalizeRoute(route, parent, depth || 0, force)).filter(Boolean);\n  Object.defineProperty(routes, '_normalized', { value: true });\n  return routes;\n}\n\nfunction normalizeRoutePath(path: string, route?: any, append?: boolean, basename = '') {\n  if (isAbsoluteUrl(path)) return path;\n  if (route && route.matched) route = route.matched[route.matched.length - 1];\n  if (!path || path[0] === '/' || !route) return basename + (path || '');\n  if (route.config) route = route.config;\n  let parent = (append || /^\\.\\//.test(path)) ? route : route.parent;\n  while (parent && path[0] !== '/') {\n    path = `${parent.path}/${path}`;\n    parent = route.parent;\n  }\n  if (basename && path[0] === '/') path = basename + path;\n  return normalizePath(path);\n}\n\nfunction resloveIndex(index: string | RouteIndexFn, routes: ConfigRouteArray): any {\n  index = isFunction(index) ? (index as RouteIndexFn)() : index;\n  let r = routes.find((r: ConfigRoute) => r.subpath === index);\n  if (r && r.index) {\n    if (r.index === index) return null;\n    return resloveIndex(r.index, routes);\n  }\n  return r;\n}\n\n\ntype RoutesHandler = (r: any) => ConfigRouteArray;\n\nfunction matchRoutes(\n  routes: ConfigRouteArray | RoutesHandler,\n  to: any,\n  parent?: any,\n  branch: { route: any, match: any }[] = []\n) {\n  to = normalizeLocation(to);\n\n  if (isFunction(routes)) {\n    routes = normalizeRoutes((routes as RoutesHandler)({\n      location,\n      parent,\n      branch,\n      prevChildren: parent && parent.prevChildren\n    }), parent);\n    if (parent) parent.prevChildren = routes;\n  }\n\n  (routes as ConfigRouteArray).some(route => {\n    let match = route.path\n      ? matchPath(to.path, route)\n      : branch.length\n        ? branch[branch.length - 1].match // use parent match\n        : computeRootMatch(to.path); // use default \"root\" match\n\n    if (match && route.index) {\n      route = resloveIndex(route.index, routes as ConfigRouteArray);\n      if (!route) return;\n      else to.pathname = to.path = route.path;\n    }\n\n    if (match) {\n      branch.push({ route,  match });\n\n      if (route.children) matchRoutes(route.children, to, route, branch);\n    }\n    if (match) return true;\n  });\n\n  return branch;\n}\n\nfunction normalizeLocation(to: any, route?: any, append?: boolean, basename = ''): RouteHistoryLocation {\n  if (!to) return to;\n  if (typeof to === 'string') {\n    const [pathname, search] = to.split('?');\n    to = { pathname, path: pathname, search: search ? `?${search}` : '', fullPath: to };\n  }\n  if (to.query) Object.keys(to.query).forEach(key => (to.query[key] === undefined) && (delete to.query[key]));\n  else if (to.search) to.query = config.parseQuery(to.search.substr(1));\n\n  if (!isAbsoluteUrl(to.pathname)) {\n    to.pathname = to.path = normalizeRoutePath(to.pathname || to.path, route, to.append || append, basename) || '/';\n  }\n  to.search = to.search || (to.query ? config.stringifyQuery(to.query) : '');\n  to.fullPath = `${to.path}${to.search ? to.search : ''}`;\n  if (!to.query) to.query = {};\n  return to;\n}\n\nconst _toString = Object.prototype.toString;\nfunction isPlainObject(obj: any): obj is { [key: string]: any } {\n  return _toString.call(obj) === '[object Object]';\n}\nfunction isFunction(value: any): value is Function {\n  return typeof value === 'function';\n}\n\nfunction isMatchedRoute(value: any): value is MatchedRoute {\n  return Boolean(value.config);\n}\n\nfunction isLocation(v: any) {\n  return isPlainObject(v) && (v.path || v.pathname);\n}\n\nfunction normalizeProps(props: { [key: string]: any } | any[]) {\n  let res: { [key: string]: any } = {};\n  if (Array.isArray(props)) {\n    props.forEach(key => res[key] = { type: null });\n  } else if (isPlainObject(props)) {\n    Object.keys(props).forEach(key => {\n      let val = props[key];\n      res[key] = isPlainObject(val)\n        ? val.type !== undefined\n          ? val\n          : normalizeProps(val)\n        : { type: val };\n    });\n  } else return props;\n  return res;\n}\n\nfunction once(fn: ((...args: any) => any) | null, ctx?: any) {\n  let ret: any;\n  return function _once(...args: any[]) {\n    if (!fn) return ret;\n    const _fn = fn;\n    fn = null;\n    ret = _fn.call(ctx || this, ...args);\n    return ret;\n  };\n}\n\n\nfunction isAcceptRef(v: any) {\n  if (!v) return false;\n  if (v.$$typeof === REACT_FORWARD_REF_TYPE && v.__componentClass) return true;\n  if (v.__component) v = getGuardsComponent(v);\n\n  let ret = false;\n  if (v.prototype) {\n    if (v.prototype instanceof React.Component || v.prototype.componentDidMount !== undefined) ret = true;\n  } else if (v.$$typeof === REACT_FORWARD_REF_TYPE && !v.__guards) ret = true;\n  return ret;\n}\n\nfunction mergeFns(...fns: any[]) {\n  return function (...args: any) {\n    let ret;\n    fns.forEach(fn => {\n      ret = fn && fn.call(this, ...args);\n    });\n    return ret;\n  };\n}\n\nfunction resolveRedirect(to: any, route: any, from?: any) {\n  if (isFunction(to)) to = to.call(route, from);\n  if (!to) return '';\n  to = normalizeLocation(to, route);\n  from && Object.assign(to.query, from.query);\n  to.isRedirect = true;\n  return to;\n}\n\nfunction warn(...args: any) {\n  console.warn(...args);\n}\n\nasync function afterInterceptors(interceptors: any[], ...args: any) {\n  for (let i = 0; i < interceptors.length; i++) {\n    let interceptor = interceptors[i];\n    while (interceptor && interceptor.lazy) interceptor = await interceptor(interceptors, i);\n    if (!interceptor) return;\n\n    interceptor && await interceptor.call(this, ...args, interceptor.route);\n  }\n}\n\ntype RenderRouteOption = {\n  container?: ReactViewContainer\n  name?: string;\n  ref?: any,\n  params?: Partial<any>,\n  query?: Partial<any>,\n}\n\nfunction renderRoute(\n  route: ConfigRoute,\n  routes: ConfigRoute[],\n  props: any,\n  children: React.ReactNode | null,\n  options: RenderRouteOption = {}\n) {\n  if (props === undefined) props = {};\n  if (!route) return null;\n  if (React.isValidElement(route)) return route;\n  if (route.config) route = route.config;\n\n  function configProps(_props: any, configs: any, obj: any, name?: string) {\n    if (!obj) return;\n    if (name && configs[name] !== undefined) configs = configs[name];\n    if (configs === true) Object.assign(_props, obj);\n    else if (isPlainObject(configs)) {\n      Object.keys(configs).forEach(key => {\n        const prop = configs[key];\n        const type = prop.type;\n        let val = obj[key];\n        if (val === undefined) {\n          if (prop.default) {\n            if (typeof prop.default === 'function' && (type === Object || type === Array)) {\n              _props[key] = prop.default();\n            } else _props[key] = prop.default;\n          } else return;\n        }\n        if (type !== null) _props[key] = type(val);\n        else _props[key] = val;\n      });\n    }\n  }\n  function createComp(route: ConfigRoute, props: any, children: React.ReactNode, options: RenderRouteOption) {\n    let component = route.components && route.components[options.name || 'default'];\n    if (!component) return null;\n\n    const _props = {};\n    if (route.defaultProps) {\n      Object.assign(_props, isFunction(route.defaultProps) ? route.defaultProps(props) : route.defaultProps);\n    }\n    if (route.props) configProps(_props, route.props, options.params, options.name);\n    if (route.paramsProps) configProps(_props, route.paramsProps, options.params, options.name);\n    if (route.queryProps) configProps(_props, route.queryProps, options.query, options.name);\n\n    let ref: any = null;\n    if (component) {\n      if (isAcceptRef(component)) ref = options.ref;\n      else if (route.enableRef) {\n        if (!isFunction(route.enableRef) || route.enableRef(component)) ref = options.ref;\n      }\n    }\n    const _pending = route._pending;\n    const afterEnterGuards = _pending.afterEnterGuards[options.name as string] || [];\n    const completeCallback = _pending.completeCallbacks[options.name as string];\n    let refHandler = once((el, componentClass) => {\n      if (el || !ref) {\n        // if (isFunction(componentClass)) componentClass = componentClass(el, route);\n        if (componentClass && el && el._reactInternalFiber) {\n          let refComp = null;\n          let comp = el._reactInternalFiber;\n          while (comp && !refComp) {\n            if (comp.type === componentClass) {\n              refComp = comp;\n              break;\n            }\n            comp = comp.child;\n          }\n          if (refComp && refComp.stateNode instanceof componentClass) el = refComp.stateNode;\n          else warn('componentClass', componentClass, 'not found in route component: ', el);\n        }\n        completeCallback && completeCallback(el);\n        afterEnterGuards && afterInterceptors.call(el, afterEnterGuards);\n      }\n    });\n    _pending.completeCallbacks[options.name as string] = null;\n    _pending.afterEnterGuards[options.name as string] = [];\n    if (ref) ref = mergeFns(ref, (el: any) => el && refHandler && refHandler(el, component.__componentClass));\n    if (component.__component) component = getGuardsComponent(component);\n    let ret;\n    if (component instanceof RouteLazy) {\n      ret = null;\n      warn(`route [${route.path}] component should not be RouteLazy instance!`);\n    } else {\n      ret = React.createElement(\n        component,\n        Object.assign(\n          _props,\n          props,\n          config.inheritProps ? { route } : null,\n          { ref }\n        ),\n        ...(Array.isArray(children) ? children : [children])\n      );\n    }\n    if (!ref) nextTick(refHandler);\n    return ret;\n  }\n\n  let renderRoute = route;\n  if (route.redirect) return null;\n  if (route.index) renderRoute = resloveIndex(route.index, routes);\n  if (!renderRoute) return null;\n\n  let result = createComp(renderRoute, props, children, options) as any;\n  if (options.container) result = options.container(result, route, props);\n  return result;\n}\n\nfunction flatten(array: any[]) {\n  let flattend: any[] = [];\n  (function flat(array) {\n    array.forEach(function (el) {\n      if (Array.isArray(el)) flat(el);\n      else flattend.push(el);\n    });\n  })(array);\n  return flattend;\n}\n\nfunction camelize(str: string): string {\n  let ret = str.replace(/[-|:](\\w)/g, function (_, c) { return c ? c.toUpperCase() : ''; });\n  if (/^[A-Z]/.test(ret)) ret = ret.charAt(0).toLowerCase() + ret.substr(1);\n  return ret;\n}\n\nfunction isPropChanged(prev: { [key: string]: any }, next: { [key: string]: any }) {\n  if ((!prev || !next) && prev !== next) return true;\n  return Object.keys(next).some(key => next[key] !== prev[key]);\n}\n\nfunction isRouteChanged(prev: ConfigRoute | null, next: ConfigRoute | null) {\n  if (prev && next) return prev.path !== next.path && prev.subpath !== next.subpath;\n  if ((!prev || !next) && prev !== next) return true;\n  return false;\n}\n\nfunction isRoutesChanged(prevs: ConfigRoute[], nexts: ConfigRoute[]) {\n  if (!prevs || !nexts) return true;\n  if (prevs.length !== nexts.length) return true;\n  let changed = false;\n  prevs.some((prev, i) => {\n    changed = isRouteChanged(prev, nexts[i]);\n    return changed;\n  });\n  return changed;\n}\n\nfunction getHostRouterView(ctx: any, continueCb?: any) {\n  let parent = ctx._reactInternalFiber.return;\n  while (parent) {\n    if (continueCb && continueCb(parent) === false) return;\n\n    const memoizedState = parent.memoizedState;\n    // const memoizedProps = parent.memoizedProps;\n    if (memoizedState && memoizedState._routerView) return parent.stateNode;\n    parent = parent.return;\n  }\n}\n\nfunction getParentRoute(ctx: any) {\n  const view = getHostRouterView(ctx);\n  return (view && view.state.currentRoute) || null;\n}\n\nfunction isAbsoluteUrl(to: any) {\n  return typeof to === 'string' && /^(https?:)?\\/\\/.+/.test(to);\n}\n\nexport {\n  camelize,\n  flatten,\n  warn,\n  once,\n  mergeFns,\n  isAcceptRef,\n  nextTick,\n  isPlainObject,\n  isFunction,\n  isMatchedRoute,\n  isLocation,\n  isPropChanged,\n  isRouteChanged,\n  isRoutesChanged,\n  isAbsoluteUrl,\n  resolveRedirect,\n  normalizePath,\n  normalizeRoute,\n  normalizeRoutes,\n  normalizeRoutePath,\n  normalizeLocation,\n  normalizeProps,\n  matchPath,\n  matchRoutes,\n  renderRoute,\n  innumerable,\n  afterInterceptors,\n  getParentRoute,\n  getHostRouterView\n};\n"],"file":"util.js"}