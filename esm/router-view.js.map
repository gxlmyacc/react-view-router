{"version":3,"sources":["../src/router-view.ts"],"names":["RouterView","props","router","depth","Number","state","_routerView","_routerRoot","_routerParent","_routerDepth","_routerInited","_routerResolving","parentRoute","currentRoute","routes","_filterRoutes","_isMounted","target","_updateRef","bind","ref","componentInstances","name","setState","filter","ret","r","config","hasName","redirect","index","components","component","default","matched","route","length","newState","_getRouteMatch","createMatchedRoute","path","push","viewInstances","Object","assign","resolving","Boolean","fallback","inited","subpath","viewRoot","_handleRouteInterceptor","history","location","ok","to","_refreshCurrentRoute","_reactInternalFiber","parent","children","console","error","nextProps","nextState","idx","len","splice","findIndex","indexOf","undefined","excludeProps","container","query","params","targetExcludeProps","defaultProps","forEach","key","isNull","getComponent","_resolveFallback","renderCurrent","React","createElement","Fragment","Component","forwardRef"],"mappings":"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","sourcesContent":["import React, { ReactElement } from 'react';\nimport {\n  renderRoute, normalizeRoute, normalizeRoutes, isFunction,\n  isRouteChanged, isRoutesChanged, isPropChanged,\n  getHostRouterView\n} from './util';\nimport ReactViewRouter from './router';\nimport { ConfigRoute, ConfigRouteArray } from './types';\n\ntype RouterViewUpdateRef = (vm: React.Component | null) => void;\n\ntype RouterViewProps = {\n  name?: string,\n  filter?: RouterViewFilter,\n  fallback?: ReactViewFallback,\n  container?: ReactViewContainer,\n  router?: ReactViewRouter,\n  depth?: number,\n  _updateRef?: RouterViewUpdateRef,\n  excludeProps: string[],\n} & { [key: string]: any };\n\ntype RouterViewState = {\n  _routerView: RouterView,\n  _routerRoot: boolean,\n  _routerParent: RouterView | null,\n  _routerDepth: number,\n  _routerInited: boolean,\n  _routerResolving: boolean,\n\n  router?: ReactViewRouter,\n  parentRoute: ConfigRoute | null,\n  currentRoute: ConfigRoute | null,\n  routes: ConfigRoute[],\n}\n\nexport type RouterViewFilter = (route: ConfigRoute[], state: RouterViewState) => ConfigRoute[];\nexport type ReactViewFallback = (state: {\n  parentRoute: ConfigRoute | null,\n  currentRoute: ConfigRoute | null,\n  inited: boolean,\n  resolving: boolean,\n  depth: number\n}) => React.ReactElement;\nexport type ReactViewContainer = (\n  result: React.ReactElement | null,\n  route: ConfigRoute,\n  props: RouterViewProps\n) => React.ReactElement;\n\nclass RouterView extends React.Component<RouterViewProps, RouterViewState> {\n\n  _isMounted: boolean;\n  target: typeof RouterView;\n  _reactInternalFiber: any;\n  static defaultProps: {\n    excludeProps: string[];\n  };\n\n  constructor(props: RouterViewProps) {\n    super(props);\n    const router = props && props.router;\n    const depth = (props && props.depth) ? Number(props.depth) : 0;\n    const state: RouterViewState = {\n      _routerView: this,\n      _routerRoot: true,\n      _routerParent: null,\n      _routerDepth: depth,\n      _routerInited: false,\n      _routerResolving: false,\n\n      router,\n      parentRoute: null,\n      currentRoute: null,\n      routes: router ? this._filterRoutes(router.routes) : [],\n    };\n    this._isMounted = false;\n    this.state = state;\n    this.target = new.target;\n\n    this._updateRef = this._updateRef.bind(this);\n    this._filterRoutes = this._filterRoutes.bind(this);\n  }\n\n  get name() {\n    return this.props.name || 'default';\n  }\n\n  _updateRef(ref: React.Component) {\n    let currentRoute = this.state.currentRoute;\n    if (currentRoute) currentRoute.componentInstances[this.name] = ref;\n    if (this.props && this.props._updateRef) this.props._updateRef(ref);\n    if (this._isMounted) this.setState({ currentRoute });\n  }\n\n  _filterRoutes(routes: ConfigRouteArray, state?: RouterViewState) {\n    const { name, filter } = this.props;\n    let ret = routes && routes.filter(r => {\n      if (r.config) r = r.config;\n      const hasName = name && name !== 'default';\n      if (r.redirect || r.index) return hasName ? name === r.name : !r.name;\n      return hasName\n        ? (r.components && r.components[name as string])\n        : r.component || (r.components && r.components.default);\n    });\n    if (filter) ret = filter(ret, state || this.state);\n    return ret;\n  }\n\n  _getRouteMatch(state: RouterViewState, depth = 0) {\n    if (!state) state = this.state;\n    const matched = (state.router && state.router.currentRoute && state.router.currentRoute.matched) || [];\n    let route = matched.length > depth ? matched[depth] : null;\n    return route ? route.config : null;\n  }\n\n  _refreshCurrentRoute(state?: any, newState?: any) {\n    if (!state) state = this.state;\n    let currentRoute = this._getRouteMatch(state, state._routerDepth);\n    if (!currentRoute) {\n      currentRoute = state.router.createMatchedRoute(\n        normalizeRoute({ path: '' }, state.parentRoute, state._routerDepth),\n        state.parentRoute\n      );\n      state.router.currentRoute && state.router.currentRoute.matched.push(currentRoute);\n    } else if (!currentRoute || currentRoute.redirect) currentRoute = null;\n\n    if (currentRoute) currentRoute.viewInstances[this.name] = this;\n    if (this.state && this.state._routerInited) {\n      if (newState) Object.assign(newState, { currentRoute });\n      else if (this._isMounted) this.setState({ currentRoute });\n    }\n    return currentRoute;\n  }\n\n  _updateResolving(resolving: any) {\n    if (this._isMounted) this.setState({ _routerResolving: Boolean(resolving) });\n  }\n\n  _resolveFallback() {\n    let ret = null;\n    let fallback = this.props.fallback;\n    if (isFunction(fallback)) {\n      ret = fallback({\n        parentRoute: this.state.parentRoute,\n        currentRoute: this.state.currentRoute,\n        inited: this.state._routerInited,\n        resolving: this.state._routerResolving,\n        depth: this.state._routerDepth\n      });\n    }\n    return ret || null;\n  }\n\n  isNull(route: any) {\n    return !route || !route.path || route.subpath === '';\n  }\n\n  async componentDidMount() {\n    this._isMounted = true;\n    if (this.state._routerInited) return;\n    const state = { ...this.state };\n\n    if (state._routerRoot && state.router) {\n      state.router.viewRoot = this;\n      state.router._handleRouteInterceptor(\n        state.router.history.location,\n        (ok, to) => {\n          if (!ok) return;\n          // this.state.router && (this.state.router.currentRoute = to);\n          state.currentRoute = this._refreshCurrentRoute();\n          if (this._isMounted) this.setState(Object.assign(state, { _routerInited: true }));\n        },\n        true,\n      );\n      return;\n    }\n\n    if (!this._reactInternalFiber) return;\n\n    let parent = getHostRouterView(this);\n    if (parent) {\n      state._routerRoot = false;\n      state._routerParent = parent.state._routerView;\n      if (!state.router) state.router = parent.state.router;\n      state._routerDepth = parent.state._routerDepth + 1;\n    }\n\n    if (state._routerDepth) {\n      state.parentRoute = this._getRouteMatch(state, state._routerDepth - 1);\n      state.routes = state.parentRoute ? this._filterRoutes(state.parentRoute.config.children) : [];\n      state.currentRoute = this._refreshCurrentRoute(state);\n    } else console.error('[RouterView] cannot find root RouterView instance!', this);\n\n    if (this._isMounted) this.setState(Object.assign(state, { _routerInited: true }));\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  shouldComponentUpdate(nextProps: RouterViewProps, nextState: RouterViewState) {\n    if (!this._isMounted) return false;\n    if (this.state._routerResolving !== nextState._routerResolving) return true;\n    if (this.state._routerInited !== nextState._routerInited) return true;\n    if (this.state._routerDepth !== nextState._routerDepth) return true;\n    if (this.state.router !== nextState.router) return true;\n    if (isPropChanged(this.props, nextProps)) return true;\n    if (isRouteChanged(this.state.currentRoute, nextState.currentRoute)) return true;\n    if (isRoutesChanged(this.state.routes, nextState.routes)) return true;\n    return false;\n  }\n\n  push(...routes: ConfigRoute[]) {\n    const state = { ...this.state };\n    state.routes.push(...normalizeRoutes(routes, state.parentRoute));\n    if (this._isMounted) this.setState(state);\n    return state.routes;\n  }\n\n  splice(idx: number, len: number, ...routes: ConfigRoute[]) {\n    const state = { ...this.state };\n    state.routes.splice(idx, len, ...normalizeRoutes(routes, state.parentRoute));\n    if (this._isMounted) this.setState(state);\n    return state.routes;\n  }\n\n  indexOf(route: string | ConfigRoute) {\n    if (typeof route === 'string') route = { path: route } as ConfigRoute;\n    const { routes } = this.state;\n    return routes.findIndex(r => r.path === (route as ConfigRoute).path);\n  }\n\n  remove(route: string | ConfigRoute) {\n    if (typeof route === 'string') route = { path: route } as ConfigRoute;\n    const { routes } = this.state;\n    const index = this.indexOf(route);\n    if (~index) routes.splice(index, 1);\n    if (this._isMounted) this.setState({ routes });\n    return ~index ? route : undefined;\n  }\n\n  getComponent(currentRoute: ConfigRoute | null, excludeProps?: Partial<any>) {\n    if (!currentRoute) return null;\n\n    const { routes, router } = this.state;\n    const { container, children, ...props } = this.props;\n    const { query = {}, params } = ((router && router.currentRoute) || {});\n\n    const targetExcludeProps = this.target.defaultProps.excludeProps || RouterView.defaultProps.excludeProps || [];\n    (excludeProps || targetExcludeProps).forEach((key: string) => delete (props as any)[key]);\n\n    return renderRoute(currentRoute, routes, props,\n      children,\n      {\n        name: this.name,\n        query,\n        params,\n        container,\n        ref: this._updateRef\n      });\n  }\n\n  renderCurrent(currentRoute: ConfigRoute | null) {\n    if (this.isNull(currentRoute)) return this.props.children || null;\n    return this.getComponent(currentRoute);\n  }\n\n  render() {\n    if (!this.state._routerInited) return this._resolveFallback();\n\n    let ret = this.renderCurrent(this.state.currentRoute);\n\n    if (this.state._routerResolving) {\n      ret = React.createElement(React.Fragment, {}, ret, this._resolveFallback());\n    }\n\n    return ret;\n  }\n\n}\n\nRouterView.defaultProps = {\n  excludeProps: ['_updateRef', 'router', 'excludeProps']\n};\n\nexport {\n  RouterView as RouterViewComponent\n};\n\nexport default React.forwardRef((\n  props: any,\n  ref: any\n) => React.createElement(RouterView, {\n  ...props,\n  _updateRef: ref\n}));\n"],"file":"router-view.js"}